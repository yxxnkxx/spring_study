# 다양한 연관관계 매핑

## 다대일 [N:1]

다[N] 쪽에 외래키 존재 → 연관관계의 주인

## 일대다 [1:N]

권장 X

일[1]이 연관관계의 주인 vs 테이블 일대다 관계는 항상 다[N] 쪽에 외래 키 존재

`@JoinColumn`을 추가하지 않으면 JoinTable이 새로 생성됨

단점: 엔티티가 관리하는 외래 키가 다른 테이블에 존재 → 연관관계 관리를 위해  **update 쿼리 추가 실행**

→ **다대일 연관관계에 양방향 매핑 추가 권장**

## 일대일 [1:1]

주 테이블, 대상 테이블 중에 외래 키 선택 가능

외래 키에 데이터베이스 유니크 제약조건 추가

### 주 테이블에 외래 키

연관관계의 주인에 Joincolumn 지정, 연관관계의 주인이 아닌 곳에 mappedBy 추가

→ @ManyToOne과 유사

주 객체가 대상 객체의 참조를 가지는 것처럼 주 테이블에 외래키를 두고 대상 테이블을 찾음

- 객체지향 개발자 선호
- JPA 매핑이 편리

장점: 주 테이블만 조회해도 대상 테이블에 데이터가 있는지 확인 가능

단점: 값이 없으면 외래 키에 null 허용

### 대상 테이블에 외래 키

대상 테이블에 외래키가 존재

단방향: 지원X

양방향: 주 테이블에 외래키 양방향과 구조상 동일

- 전통적인 데이터베이스 개발자 선호

장점: 일대일 → 일대다(주:대상) 변경시 테이블 구조 유지 가능

단점: **지연 로딩으로 설정해도 항상 즉시 로딩됨** (프록시 기능의 한계)

## 다대다 [N:M]

관계형 데이터베이스: 정규화된 테이블 2개로 다대다 관계 표현 X

연결 테이블을 추가해서 일대다 - 다대일 관계

객체는 컬렉션을 사용해서 객체 2개로 다대다 관계 가능

한계: 중간 테이블에 필요한 정보 추가 불가능

→ 개선: 중간 테이블을 엔티티로 승격, 일대다 다대일 관계로 변경